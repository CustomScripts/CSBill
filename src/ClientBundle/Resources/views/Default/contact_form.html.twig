{#
 # This file is part of SolidInvoice package.
 #
 # (c) 2013-2015 Pierre du Plessis <info@customscripts.co.za>
 #
 # This source file is subject to the MIT license that is bundled
 # with this source code in the file LICENSE.
 #}

{% import "@SolidInvoiceCore/Form/macro.html.twig" as _macro %}

{{ form_start(form) }}

    {{ form_errors(form) }}

    <div class="row">
        <div class="col-lg-6 col-md-6" id="client-address-collection">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">{{ 'client.info'|trans }}</h3>
                </div>

                <div class="box-body">
                    {{ form_row(form.name) }}
                    {{ form_row(form.website) }}
                    {{ form_row(form.currency) }}
                    {{ form_row(form.vat_number) }}
                </div>
            </div>

            <box title="{{ form.addresses.vars.label }}">
                <template slot="body">
                    {{ form_row(form.addresses) }}
                </template>
            </box>

            {#<div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">{{ 'client.address.info'|trans }}</h3>
                </div>

                <div class="box-body">
                    {% set addressesPrototypeForm %}
                        {{ _macro.widget_prototype(form.addresses, 'client.address.delete'|trans, {'trash' : {'class' : 'pull-right btn-flat btn btn-danger'} }) }}
                    {% endset %}

                    <div class="client_addresses" data-prototype="{{ addressesPrototypeForm|escape }}" data-prototype-name="{{ form.addresses.vars.prototype.vars.name }}">
                        {% for widget in form.addresses %}
                            {{ _macro.widget_prototype(widget, 'client.address.delete'|trans, {'trash' : {'class' : 'pull-right btn-flat btn btn-danger'}}) }}
                        {% else %}
                            {{ addressesPrototypeForm|replace({'__name__' : 0})|raw }}
                        {% endfor %}
                    </div>
                </div>

                <div class="box-footer">
                    <a href="#" data-target="client_addresses" class="btn-flat btn-add add_form_collection_link">
                        {{ icon('plus', ['circle']) }} {{ "client.address.add"|trans }}
                    </a>
                </div>
            </div>#}
        </div>

        {#<box title="{{ 'client.contact.info'|trans }}">#}



            <div class="col-lg-6 col-md-6">
                <box title="{{ form.contacts.vars.label }}">
                    <template slot="body">
                        {% if form.contacts|length > 0 %}
                            <form-collection :allow-delete="{{ form.contacts.vars.allow_delete ? 'true' : 'false' }}" ref="{{ form.contacts.vars.id }}" id="{{ form.contacts.vars.id }}">
                                <template slot="prototype" slot-scope="props">



                                    {{- form_row(widget)|replace({
                                        (prototype.vars.name): "' + props.index + '"
                                    })|raw -}}

                                    {% if form.contacts.vars.allow_add %}
                                        <portal to="{{ form.contacts.vars.label }}">
                                            <a @click="addRow('{{ form.contacts.vars.id }}')">{{ icon('plus') }} Add {{ form.contacts.vars.label|default(form.contacts.vars.name)|humanize|title }}</a>
                                        </portal>
                                    {% endif %}
                                </template>
                            </form-collection>
                        {% else %}
                            {{ form_row(form.contacts) }}
                        {% endif %}
                    </template>
                    {#<template slot="footer">
                        <a href="#" data-target="client_contacts" class="btn-flat btn-add add_form_collection_link">
                            {{ icon('plus', ['circle']) }} {{ "client.contact.add"|trans }}
                        </a>
                    </template>#}
                </box>
            </div>
            {#<div class="col-lg-6 col-md-6">
                <box title="{{ form.contacts.vars.label }}">
                    <template slot="body">
                    </template>
                    #}{#<template slot="footer">
                        <a href="#" data-target="client_contacts" class="btn-flat btn-add add_form_collection_link">
                            {{ icon('plus', ['circle']) }} {{ "client.contact.add"|trans }}
                        </a>
                    </template>#}{#
                </box>
            </div>#}

        {#<div class="col-lg-6 col-md-6" id="client-contacts-collection">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">{{ 'client.contact.info'|trans }}</h3>
                </div>

                <div class="box-body">

                    #}{#{% set prototypeForm %}
                        {{ _macro.widget_prototype(form.contacts, 'client.contact.delete'|trans, {'trash' : {'class' : 'pull-right btn btn-flat btn-danger'} }) }}
                    {% endset %}

                    <div class="client_contacts" data-prototype="{{ prototypeForm|escape }}" data-prototype-name="{{ form.contacts.vars.prototype.vars.name }}">
                        {% for widget in form.contacts %}
                            {{ _macro.widget_prototype(widget, 'client.contact.delete'|trans, {'trash' : {'class' : 'pull-right btn btn-flat btn-danger'}}) }}
                        {% else %}
                            {{ prototypeForm|replace({'__contact_prototype__' : 0})|raw }}
                        {% endfor %}
                    </div>#}{#
                </div>

                <div class="box-footer">
                    <a href="#" data-target="client_contacts" class="btn-flat btn-add add_form_collection_link">
                        {{ icon('plus', ['circle']) }} {{ "client.contact.add"|trans }}
                    </a>
                </div>
            </div>
        </div>#}
    </div>

    {{ form_rest(form) }}

    <hr class="clear" />

    <div class="control-group">
        <div class="controls">
            <div class="pull-left">
                <button type="button" class="btn btn-warning" onclick="history.back()">
                    {{ icon('reply') }} {{ 'client.cancel'|trans }}
                </button>
            </div>
            <div class="pull-right">
                <button type="submit" class="btn btn-success">
                    {{ icon('save') }} {{ "client.save"|trans }}
                </button>
            </div>
        </div>
    </div>
{{ form_end(form) }}
