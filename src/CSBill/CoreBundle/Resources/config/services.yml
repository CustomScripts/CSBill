parameters:
    csbill_core.form.help.extension.class: CSBill\CoreBundle\Form\Extension\FormHelpExtension
    csbill_core.billing.mailer.class: CSBill\CoreBundle\Mailer\Mailer
    csbill_core.form.type.image_upload.class: CSBill\CoreBundle\Form\Type\ImageUpload
    csbill_core.form.type.select2.class: CSBill\CoreBundle\Form\Type\Select2
    csbill_core.security.encryption.class: CSBill\CoreBundle\Security\Encryption
    csbill_core.session.request.listener.class: CSBill\CoreBundle\Listener\SessionRequestListener
    csbill_core.settings.loader.class: CSBill\CoreBundle\Settings\SettingsLoader
    csbill_menu.top.class: CSBill\CoreBundle\Menu\Builder
services:
    csbill.core.config_writer:
        class: CSBill\CoreBundle\ConfigWriter
        arguments:
            - '%kernel.root_dir%'
            - '@kernel'
            - '@filesystem'
    csbill_core.form.help.extension:
        class: '%csbill_core.form.help.extension.class%'
        tags:
            - { name: form.type_extension, extended_type: Symfony\Component\Form\Extension\Core\Type\FormType }

    billing.mailer:
        class: '%csbill_core.billing.mailer.class%'
        arguments:
            - '@mailer'
            - '@settings'
        calls:
            - [setEventDispatcher, ['@event_dispatcher']]
            - [setTemplating, ['@templating']]
            - [setSecurity, ['@security.token_storage']]

    csbill_core.form.type.image_upload:
        class: '%csbill_core.form.type.image_upload.class%'
        arguments:
            - '@session'
            - '@security.encryption'
        tags:
            - { name: form.type }

    csbill_core.form.type.select2:
        class: '%csbill_core.form.type.select2.class%'
        tags:
            - { name: form.type }

    csbill_core.security.encryption:
        class: '%csbill_core.security.encryption.class%'
        arguments:
            - '%kernel.secret%'

    security.encryption:
        alias: csbill_core.security.encryption

    csbill_core.session.request.listener:
        class: '%csbill_core.session.request.listener.class%'
        arguments:
            - '@session'
            - '@security.encryption'
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: 200 }

    csbill_core.settings.loader:
        class: '%csbill_core.settings.loader.class%'
        arguments:
            - '@kernel'
            - '@csbill.core.config_writer'
        tags:
            - { name: settings.loader }

    csbill_core.swiftmailer.plugin.cssinline:
        class: CSBill\CoreBundle\Swiftmailer\Plugin\CssInlinerPlugin
        arguments:
            - '@csbill_core.cssinline'
        tags:
            - { name: swiftmailer.default.plugin }

    csbill_core.cssinline:
        class: TijsVerkoyen\CssToInlineStyles\CssToInlineStyles
        public: false

    oro.cache.abstract:
        class: Doctrine\Common\Cache\FilesystemCache
        arguments:
            - '%kernel.cache_dir%/requirejs'
    csbill_menu.top:
        class: '%csbill_menu.top.class%'
        tags:
            - { name: cs_core.menu, menu: top_right, method: systemMenu, priority: 255 }
            - { name: cs_core.menu, menu: top_right, method: userMenu, priority: 255 }
